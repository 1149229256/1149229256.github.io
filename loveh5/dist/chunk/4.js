(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{"107":function(t,e,o){"use strict";o.d(e,"a",(function(){return r}));var s=o(7),n=o(124),a=o.n(n);window.location.protocol,window.location.host;window.BasicProxy="http://192.168.129.178:8889/";var r=function axiosMethod(t,e,o,n){return a()({"baseURL":"http://192.168.129.178:8889/","method":t,"url":e,"params":"get"===t?o:{},"data":"get"===t?{}:o,"headers":Object(s.a)({"Content-Type":"get"===t?"application/x-www-form-urlencoded":"application/json"},n)})};a.a.interceptors.request.use((function(t){return t}),(function(t){return Promise.reject(t)}))},"156":function(t,e,o){},"157":function(t,e,o){},"158":function(t,e,o){},"166":function(t,e,o){"use strict";o.r(e);var s=o(9),n=o(19),a=o(31),r=o(102),i=o(123),c=o(5),l=o(6),h=o(16),p=o(12),d=o(13),u=o(8),g=(o(156),o(101)),j=function(t){Object(p.a)(LgRefreshPage,t);var e=Object(d.a)(LgRefreshPage);function LgRefreshPage(t){var o;Object(c.a)(this,LgRefreshPage),o=e.call(this,t),Object(u.a)(Object(h.a)(o),"start_p",null),Object(u.a)(Object(h.a)(o),"isInTop",!0),Object(u.a)(Object(h.a)(o),"isInBottom",!0);var s=Object(a.getSystemInfoSync)().windowHeight;return o.state={"dargStyle":{"top":"0px"},"downDragStyle":{"height":"0px"},"downText":o.props.downText?o.props.downText[0]:"下拉刷新","upDragStyle":{"height":"0px"},"pullText":o.props.pullText?o.props.pullText[0]:"上拉加载更多","scrollY":!0,"dargState":0,"windowHeight":s},o}return Object(l.a)(LgRefreshPage,[{"key":"reduction","value":function reduction(){var t=this;this.setState({"upDragStyle":{"height":"0px","transition":"all ".concat(.5,"s")},"dargState":0,"dargStyle":{"top":"0px","transition":"all ".concat(.5,"s")},"downDragStyle":{"height":"0px","transition":"all ".concat(.5,"s")},"scrollY":!0}),setTimeout((function(){t.setState({"dargStyle":{"top":"0px"},"upDragStyle":{"height":"0px"},"pullText":t.props.pullText?t.props.pullText[0]:"上拉加载更多","downText":t.props.downText?t.props.downText[0]:"下拉刷新"})}),500)}},{"key":"touchmove","value":function touchmove(t){if(console.log(this.isInTop,this.isInBottom),this.isInTop||this.isInBottom)if(this.start_p){var e=t.touches[0],o=this.start_p.clientX,s=this.start_p.clientY,n=e.clientX,a=e.clientY;if(Math.abs(n-o)/Math.abs(a-s)<.3){var r=Math.abs(a-s)/3.5;if(a-s>0){if(!this.isInTop)return;var i=this.props.downText;r>=70?this.setState({"dargState":1,"downText":i&&i[1]?i[1]:"释放刷新"}):this.setState({"dargState":0,"downText":i&&i[0]?i[0]:"下拉刷新"}),r>=100&&(r=100),this.setState({"dargStyle":{"top":r+"px"},"downDragStyle":{"height":r+"px"},"scrollY":!1})}if(s-a>0){if(!this.isInBottom)return;var c=this.props.pullText;r>=70?this.setState({"dargState":-1,"pullText":c&&c[1]?c[1]:"释放加载更多"}):this.setState({"dargState":0,"pullText":c&&c[0]?c[0]:"上拉加载更多"}),r>=100&&(r=100),this.setState({"dargStyle":{"top":-r+"px"},"upDragStyle":{"height":r+"px"},"scrollY":!1})}}}else this.start_p=t.touches[0]}},{"key":"pull","value":function pull(){console.log("上拉"),this.props.onPull&&this.props.onPull()}},{"key":"down","value":function down(){console.log("下拉"),this.props.onDown&&this.props.onDown()}},{"key":"ScrollToUpper","value":function ScrollToUpper(){console.log("滚动到顶部事件"),this.props.onUpper&&this.props.onUpper()}},{"key":"ScrollToLower","value":function ScrollToLower(){console.log("滚动到底部事件"),this.props.onLower&&this.props.onLower()}},{"key":"touchEnd","value":function touchEnd(t){this.start_p=null,(this.isInTop||this.isInBottom)&&(1===this.state.dargState?this.down():-1===this.state.dargState&&this.pull(),this.reduction())}},{"key":"scrollPage","value":function scrollPage(t){this.isInTop=t.detail.scrollTop<10,this.isInBottom=t.detail.scrollHeight-(t.detail.scrollTop+this.state.windowHeight)<10,console.log(this.isInTop,this.isInBottom)}},{"key":"render","value":function render(){var t=this.state.dargStyle,e=this.state.downDragStyle,o=this.state.upDragStyle,s=this.props.style||{"width":"100%"};return this.props.height&&(s.height=this.props.height),Object(g.jsxs)(r.q,{"className":"dragUpdataPage ".concat(this.props.className||""),"style":s,"children":[this.props.onDown?Object(g.jsxs)(r.q,{"className":"downDragBox","style":e,"children":[Object(g.jsx)(i.a,{}),Object(g.jsx)(r.o,{"className":"downText ".concat(1==this.state.dargState?"downText_cho":""),"children":this.state.downText})]}):null,Object(g.jsx)(r.j,{"style":t,"onScroll":this.scrollPage.bind(this),"onTouchMove":this.touchmove.bind(this),"onTouchEnd":this.touchEnd.bind(this),"upperThreshold":20,"lowerThreshold":20,"onScrollToUpper":this.ScrollToUpper.bind(this),"onScrollToLower":this.ScrollToLower.bind(this),"className":"dragUpdata","scrollY":!0,"scrollWithAnimation":!0,"children":Object(g.jsx)(r.q,{"className":"dragUpdataPage_children","style":"width:100%;","children":this.props.children})}),this.props.onPull?Object(g.jsxs)(r.q,{"className":"upDragBox","style":o,"children":[Object(g.jsx)(i.a,{}),Object(g.jsx)(r.o,{"className":"downText ".concat(-1==this.state.dargState?"downText_cho":""),"children":this.state.pullText})]}):null]})}}]),LgRefreshPage}(n.Component),x=o(107),w=function constructionDate(t,e){var o=(t=t?new Date(t):new Date).getFullYear(),s=t.getMonth()+1,n=t.getDate(),a=t.getHours(),r=t.getMinutes(),i=t.getSeconds();return s<10&&(s="0"+s),n<10&&(n="0"+n),a<10&&(a="0"+a),r<10&&(r="0"+r),i<10&&(i="0"+i),2==e?o+"-"+s+"-"+n+" "+a+":"+r:o+"-"+s+"-"+n+" "+a+":"+r+":"+i};o(157);var b=function Empty(t){var e=t.text;return Object(g.jsxs)(r.q,{"className":"my_empty","children":[Object(g.jsx)(r.q,{"className":"empty_image"}),Object(g.jsx)(r.q,{"className":"empty_text","children":e||"暂无数据"})]})};o(158);e.default=function WordWall(t){var e=Object(n.useState)(1),o=Object(s.a)(e,2),c=o[0],l=o[1],h=Object(n.useState)([]),p=Object(s.a)(h,2),d=p[0],u=p[1],f=Object(n.useState)(!1),m=Object(s.a)(f,2),S=m[0],O=m[1],T=Object(n.useState)(""),y=Object(s.a)(T,2),v=y[0],N=y[1],I=function getWordList(){Object(x.a)("get","info/getWordList",{"page":c,"pageSize":10}).then((function(t){var e=t.data;if(200===e.code&&Array.isArray(e.data))if(1===c)u(e.data);else{var o=JSON.parse(JSON.stringify(d));o=o.concat(e.data),u(o)}}))};Object(n.useEffect)((function(){I()}),[c]);var D=function changeAddDrawer(t){O(t),t||N("")};return Object(g.jsxs)(j,{"className":"word_container","height":"100vh","onPull":function onPull(t){t||l(c+1)},"onDown":function onDown(t){t||l(1)},"downText":["下拉刷新","释放刷新"],"pullText":["上拉加载更多","释放加载更多"],"children":[Object(g.jsx)(r.q,{"className":"word_wall","children":d.length>0?d.map((function(t,e){return Object(g.jsxs)(r.q,{"className":"word_one","children":[Object(g.jsx)(r.q,{"className":"word_header","style":{"backgroundImage":"url('".concat(window.BasicProxy+t.headerImage,"')")}}),Object(g.jsxs)(r.q,{"className":"user_name","children":[t.userName,Object(g.jsx)(r.o,{"children":t.publishTime})]}),Object(g.jsx)(r.q,{"className":"word_content","children":t.content}),Object(g.jsxs)(r.q,{"className":"btn_container","children":[Object(g.jsx)(r.q,{"className":"zanlogo"}),t.zanCount]})]},e)})):Object(g.jsx)(b,{"text":"暂无留言~"})}),Object(g.jsx)(r.q,{"className":"add_btn","onClick":function onClick(){return D(!0)}}),Object(g.jsxs)(i.c,{"isOpened":S,"title":"添加留言","onClose":function onClose(){return D(!1)},"children":[Object(g.jsx)(i.i,{"value":v,"onChange":function changeWordContent(t){N(t)},"maxLength":200,"placeholder":"请输入留言内容..."}),Object(g.jsx)(r.q,{"className":"confirm_btn","onClick":function addWord(){var t=sessionStorage.getItem("userInfo")?JSON.parse(sessionStorage.getItem("userInfo")):{};Object(x.a)("post","/word/addWord",{"userName":t.userName,"headerImage":t.headerImage,"publishTime":w("",2),"content":v}).then((function(t){200===t.data.code&&(Object(a.showToast)({"icon":"none","title":"添加成功"}),D(!1),I())}))},"children":"发布"})]})]})}}}]);